{"ast":null,"code":"import _defineProperty from \"/media/thet/Data/PADC/PADC 7/Repos/Day 17 - Redux Practical/react-blog-intro/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nimport _classCallCheck from \"/media/thet/Data/PADC/PADC 7/Repos/Day 17 - Redux Practical/react-blog-intro/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/media/thet/Data/PADC/PADC 7/Repos/Day 17 - Redux Practical/react-blog-intro/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/media/thet/Data/PADC/PADC 7/Repos/Day 17 - Redux Practical/react-blog-intro/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/media/thet/Data/PADC/PADC 7/Repos/Day 17 - Redux Practical/react-blog-intro/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/media/thet/Data/PADC/PADC 7/Repos/Day 17 - Redux Practical/react-blog-intro/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/media/thet/Data/PADC/PADC 7/Repos/Day 17 - Redux Practical/react-blog-intro/src/index.js\";\nimport React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport { BrowserRouter as Router, Redirect, Route, Link } from \"react-router-dom\";\nimport LoginForm from \"./components/LoginForm\";\nimport RegisterForm from \"./components/RegisterForm\";\nimport NewArticleForm from \"./components/NewArticleForm\";\nimport ArticleList from \"./components/ArticleList\";\nimport ArticleDetail from \"./components/ArticleDetail\";\nimport DeleteArticle from \"./components/DeleteArticle\";\nimport { createStore, applyMiddleware } from \"redux\";\nimport { Provider } from \"react-redux\";\nimport rootReducer from './reducers';\nimport thunk from 'redux-thunk';\n\nvar App =\n/*#__PURE__*/\nfunction (_React$Component) {\n  _inherits(App, _React$Component);\n\n  function App(props) {\n    var _this;\n\n    _classCallCheck(this, App);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(App).call(this, props));\n\n    _this.registerEvent = function (user, cb) {\n      var users = _this.state.users;\n      var result = users.find(function (obj) {\n        return obj.name === user.name || obj.email === user.email;\n      });\n\n      if (result === undefined) {\n        user.id = users.length + 1;\n        users.push(user);\n\n        _this.setStateAndLocalStorage(\"users\", users);\n\n        cb();\n      } else {\n        alert(\"User already existed\");\n      }\n    };\n\n    _this.addNewArticleEvent = function (article) {\n      var articles = _this.state.articles; //article.id = articles.length + 1;\n\n      var mapped_article_id = articles.map(function (i) {\n        return parseInt(i.id);\n      });\n      var max = Math.max(mapped_article_id);\n      article.id = max + 1;\n      article.created_by = _this.state.user.id;\n      articles.push(article);\n\n      _this.setStateAndLocalStorage(\"articles\", articles);\n    };\n\n    _this.deleteArticleEvent = function (id, cb) {\n      var articles = _this.state.articles;\n      var newArticles = articles.filter(function (item) {\n        return item.id !== id;\n      });\n\n      _this.setStateAndLocalStorage('articles', newArticles);\n\n      cb();\n    };\n\n    _this.loginEvent = function (user, cb) {\n      var users = _this.state.users;\n      var result = users.find(function (obj) {\n        return obj.name === user.name && obj.password === user.password;\n      });\n\n      if (result) {\n        _this.setState({\n          isLogin: true,\n          user: result\n        });\n\n        cb();\n      } else {\n        alert(\"Wrong password\");\n      }\n    };\n\n    _this.logoutEvent = function () {\n      _this.setState({\n        isLogin: false,\n        user: {}\n      });\n    };\n\n    _this.state = {\n      isLogin: false,\n      user: {},\n      users: [],\n      articles: [],\n      currentArticleIndex: {}\n    };\n    return _this;\n  }\n\n  _createClass(App, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this.localStorageRetrieval(\"users\");\n      this.localStorageRetrieval(\"articles\");\n    }\n  }, {\n    key: \"localStorageRetrieval\",\n    value: function localStorageRetrieval(key) {\n      var data = localStorage.getItem(key);\n\n      if (data !== null) {\n        this.setState(_defineProperty({}, key, JSON.parse(data)));\n      }\n    }\n  }, {\n    key: \"setStateAndLocalStorage\",\n    value: function setStateAndLocalStorage(key, value) {\n      this.setState(_defineProperty({}, key, value));\n      localStorage.setItem(key, JSON.stringify(value));\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      return React.createElement(Router, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 119\n        },\n        __self: this\n      }, React.createElement(\"div\", {\n        className: \"App\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 120\n        },\n        __self: this\n      }, React.createElement(\"h1\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 121\n        },\n        __self: this\n      }, \"Welcome to My Blog!\"), React.createElement(Link, {\n        to: \"/\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 122\n        },\n        __self: this\n      }, \"Home\"), \" | \", React.createElement(Link, {\n        to: \"/login\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 122\n        },\n        __self: this\n      }, \"SignIn\"), this.state.isLogin && React.createElement(React.Fragment, {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 124\n        },\n        __self: this\n      }, \"| \", React.createElement(Link, {\n        to: \"/article/new\",\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 125\n        },\n        __self: this\n      }, \"New Article\")), React.createElement(\"br\", {\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 128\n        },\n        __self: this\n      })), React.createElement(Route, {\n        path: \"/register\",\n        render: function render(props) {\n          return React.createElement(RegisterForm, Object.assign({}, props, {\n            registerEvent: _this2.registerEvent,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 133\n            },\n            __self: this\n          }));\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 130\n        },\n        __self: this\n      }), React.createElement(Route, {\n        path: \"/login\",\n        render: function render(props) {\n          return React.createElement(LoginForm, Object.assign({}, props, {\n            loginEvent: _this2.loginEvent,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 139\n            },\n            __self: this\n          }));\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 136\n        },\n        __self: this\n      }), React.createElement(Route, {\n        path: \"/article/new\",\n        render: function render(props) {\n          return _this2.state.isLogin ? React.createElement(NewArticleForm, Object.assign({}, props, {\n            addNewArticleEvent: _this2.addNewArticleEvent,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 146\n            },\n            __self: this\n          })) : React.createElement(Redirect, {\n            to: {\n              pathname: \"/login\",\n              state: {\n                from: props.location\n              }\n            },\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 151\n            },\n            __self: this\n          });\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 142\n        },\n        __self: this\n      }), React.createElement(Route, {\n        path: \"/articles/:id\",\n        exact: true,\n        render: function render(props) {\n          return React.createElement(ArticleDetail, Object.assign({}, props, {\n            articles: _this2.state.articles,\n            users: _this2.state.users,\n            currentUser: _this2.state.user,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 165\n            },\n            __self: this\n          }));\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 161\n        },\n        __self: this\n      }), React.createElement(Route, {\n        path: \"/articles/delete/:id\",\n        exact: true,\n        render: function render(props) {\n          return React.createElement(DeleteArticle, Object.assign({}, props, {\n            articles: _this2.state.articles,\n            users: _this2.state.users,\n            currentUser: _this2.state.user,\n            deleteArticleEvent: _this2.deleteArticleEvent,\n            __source: {\n              fileName: _jsxFileName,\n              lineNumber: 178\n            },\n            __self: this\n          }));\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 174\n        },\n        __self: this\n      }), React.createElement(Route, {\n        path: \"/\",\n        exact: true,\n        component: ArticleList,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 189\n        },\n        __self: this\n      }));\n    }\n  }]);\n\n  return App;\n}(React.Component);\n\nvar rootElement = document.getElementById(\"root\");\nconsole.log(rootReducer);\nvar store = createStore(rootReducer, applyMiddleware(thunk));\nReactDOM.render(React.createElement(Provider, {\n  store: store,\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 203\n  },\n  __self: this\n}, React.createElement(App, {\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 204\n  },\n  __self: this\n})), rootElement);","map":{"version":3,"sources":["/media/thet/Data/PADC/PADC 7/Repos/Day 17 - Redux Practical/react-blog-intro/src/index.js"],"names":["React","ReactDOM","BrowserRouter","Router","Redirect","Route","Link","LoginForm","RegisterForm","NewArticleForm","ArticleList","ArticleDetail","DeleteArticle","createStore","applyMiddleware","Provider","rootReducer","thunk","App","props","registerEvent","user","cb","users","state","result","find","obj","name","email","undefined","id","length","push","setStateAndLocalStorage","alert","addNewArticleEvent","article","articles","mapped_article_id","map","i","parseInt","max","Math","created_by","deleteArticleEvent","newArticles","filter","item","loginEvent","password","setState","isLogin","logoutEvent","currentArticleIndex","localStorageRetrieval","key","data","localStorage","getItem","JSON","parse","value","setItem","stringify","pathname","from","location","Component","rootElement","document","getElementById","console","log","store","render"],"mappings":";;;;;;;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,QAAP,MAAqB,WAArB;AACA,SACEC,aAAa,IAAIC,MADnB,EAEEC,QAFF,EAGEC,KAHF,EAIEC,IAJF,QAKO,kBALP;AAOA,OAAOC,SAAP,MAAsB,wBAAtB;AACA,OAAOC,YAAP,MAAyB,2BAAzB;AAEA,OAAOC,cAAP,MAA2B,6BAA3B;AACA,OAAOC,WAAP,MAAwB,0BAAxB;AACA,OAAOC,aAAP,MAA0B,4BAA1B;AACA,OAAOC,aAAP,MAA0B,4BAA1B;AAEA,SAASC,WAAT,EAAqBC,eAArB,QAA4C,OAA5C;AACA,SAASC,QAAT,QAAyB,aAAzB;AACA,OAAOC,WAAP,MAAwB,YAAxB;AACA,OAAOC,KAAP,MAAkB,aAAlB;;IAEMC,G;;;;;AACJ,eAAYC,KAAZ,EAAmB;AAAA;;AAAA;;AACjB,6EAAMA,KAAN;;AADiB,UAiBnBC,aAjBmB,GAiBH,UAACC,IAAD,EAAOC,EAAP,EAAc;AAC5B,UAAMC,KAAK,GAAG,MAAKC,KAAL,CAAWD,KAAzB;AAEA,UAAME,MAAM,GAAGF,KAAK,CAACG,IAAN,CACb,UAAAC,GAAG;AAAA,eAAIA,GAAG,CAACC,IAAJ,KAAaP,IAAI,CAACO,IAAlB,IAA0BD,GAAG,CAACE,KAAJ,KAAcR,IAAI,CAACQ,KAAjD;AAAA,OADU,CAAf;;AAIA,UAAIJ,MAAM,KAAKK,SAAf,EAA0B;AACxBT,QAAAA,IAAI,CAACU,EAAL,GAAUR,KAAK,CAACS,MAAN,GAAe,CAAzB;AACAT,QAAAA,KAAK,CAACU,IAAN,CAAWZ,IAAX;;AACA,cAAKa,uBAAL,CAA6B,OAA7B,EAAsCX,KAAtC;;AACAD,QAAAA,EAAE;AACH,OALD,MAKO;AACLa,QAAAA,KAAK,CAAC,sBAAD,CAAL;AACD;AACF,KAhCkB;;AAAA,UAkCnBC,kBAlCmB,GAkCE,UAAAC,OAAO,EAAI;AAC9B,UAAMC,QAAQ,GAAG,MAAKd,KAAL,CAAWc,QAA5B,CAD8B,CAE9B;;AAEA,UAAMC,iBAAiB,GAAGD,QAAQ,CAACE,GAAT,CAAa,UAAAC,CAAC;AAAA,eAAIC,QAAQ,CAACD,CAAC,CAACV,EAAH,CAAZ;AAAA,OAAd,CAA1B;AACA,UAAMY,GAAG,GAAGC,IAAI,CAACD,GAAL,CAASJ,iBAAT,CAAZ;AACAF,MAAAA,OAAO,CAACN,EAAR,GAAaY,GAAG,GAAG,CAAnB;AACAN,MAAAA,OAAO,CAACQ,UAAR,GAAqB,MAAKrB,KAAL,CAAWH,IAAX,CAAgBU,EAArC;AACAO,MAAAA,QAAQ,CAACL,IAAT,CAAcI,OAAd;;AACA,YAAKH,uBAAL,CAA6B,UAA7B,EAAyCI,QAAzC;AACD,KA5CkB;;AAAA,UA8CnBQ,kBA9CmB,GA8CE,UAACf,EAAD,EAAIT,EAAJ,EAAU;AAC7B,UAAMgB,QAAQ,GAAG,MAAKd,KAAL,CAAWc,QAA5B;AACA,UAAMS,WAAW,GAAIT,QAAQ,CAACU,MAAT,CAAiB,UAAAC,IAAI;AAAA,eAAIA,IAAI,CAAClB,EAAL,KAAYA,EAAhB;AAAA,OAArB,CAArB;;AACA,YAAKG,uBAAL,CAA6B,UAA7B,EAAwCa,WAAxC;;AACAzB,MAAAA,EAAE;AACH,KAnDkB;;AAAA,UAqDnB4B,UArDmB,GAqDN,UAAC7B,IAAD,EAAOC,EAAP,EAAc;AACzB,UAAMC,KAAK,GAAG,MAAKC,KAAL,CAAWD,KAAzB;AACA,UAAME,MAAM,GAAGF,KAAK,CAACG,IAAN,CACb,UAAAC,GAAG;AAAA,eAAIA,GAAG,CAACC,IAAJ,KAAaP,IAAI,CAACO,IAAlB,IAA0BD,GAAG,CAACwB,QAAJ,KAAiB9B,IAAI,CAAC8B,QAApD;AAAA,OADU,CAAf;;AAIA,UAAI1B,MAAJ,EAAY;AACV,cAAK2B,QAAL,CAAc;AACZC,UAAAA,OAAO,EAAE,IADG;AAEZhC,UAAAA,IAAI,EAAEI;AAFM,SAAd;;AAIAH,QAAAA,EAAE;AACH,OAND,MAMO;AACLa,QAAAA,KAAK,CAAC,gBAAD,CAAL;AACD;AACF,KApEkB;;AAAA,UAsEnBmB,WAtEmB,GAsEL,YAAM;AAClB,YAAKF,QAAL,CAAc;AACZC,QAAAA,OAAO,EAAE,KADG;AAEZhC,QAAAA,IAAI,EAAE;AAFM,OAAd;AAID,KA3EkB;;AAGjB,UAAKG,KAAL,GAAa;AACX6B,MAAAA,OAAO,EAAE,KADE;AAEXhC,MAAAA,IAAI,EAAE,EAFK;AAGXE,MAAAA,KAAK,EAAE,EAHI;AAIXe,MAAAA,QAAQ,EAAE,EAJC;AAKXiB,MAAAA,mBAAmB,EAAE;AALV,KAAb;AAHiB;AAUlB;;;;wCAEmB;AAClB,WAAKC,qBAAL,CAA2B,OAA3B;AACA,WAAKA,qBAAL,CAA2B,UAA3B;AACD;;;0CA8DqBC,G,EAAK;AACzB,UAAMC,IAAI,GAAGC,YAAY,CAACC,OAAb,CAAqBH,GAArB,CAAb;;AACA,UAAIC,IAAI,KAAK,IAAb,EAAmB;AACjB,aAAKN,QAAL,qBACGK,GADH,EACSI,IAAI,CAACC,KAAL,CAAWJ,IAAX,CADT;AAGD;AACF;;;4CAEuBD,G,EAAKM,K,EAAO;AAClC,WAAKX,QAAL,qBACGK,GADH,EACSM,KADT;AAGAJ,MAAAA,YAAY,CAACK,OAAb,CAAqBP,GAArB,EAA0BI,IAAI,CAACI,SAAL,CAAeF,KAAf,CAA1B;AACD;;;6BAEQ;AAAA;;AACP,aACI,oBAAC,MAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAK,QAAA,SAAS,EAAC,KAAf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,SACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,+BADF,EAEE,oBAAC,IAAD;AAAM,QAAA,EAAE,EAAC,GAAT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,gBAFF,SAE6B,oBAAC,IAAD;AAAM,QAAA,EAAE,EAAC,QAAT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAF7B,EAGG,KAAKvC,KAAL,CAAW6B,OAAX,IACC,oBAAC,KAAD,CAAO,QAAP;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eACI,oBAAC,IAAD;AAAM,QAAA,EAAE,EAAC,cAAT;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBADJ,CAJJ,EAQE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QARF,CADF,EAWE,oBAAC,KAAD;AACE,QAAA,IAAI,EAAC,WADP;AAEE,QAAA,MAAM,EAAE,gBAAAlC,KAAK;AAAA,iBACX,oBAAC,YAAD,oBAAkBA,KAAlB;AAAyB,YAAA,aAAa,EAAE,MAAI,CAACC,aAA7C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aADW;AAAA,SAFf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAXF,EAiBE,oBAAC,KAAD;AACE,QAAA,IAAI,EAAC,QADP;AAEE,QAAA,MAAM,EAAE,gBAAAD,KAAK;AAAA,iBACX,oBAAC,SAAD,oBAAeA,KAAf;AAAsB,YAAA,UAAU,EAAE,MAAI,CAAC+B,UAAvC;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aADW;AAAA,SAFf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAjBF,EAuBE,oBAAC,KAAD;AACE,QAAA,IAAI,EAAC,cADP;AAEE,QAAA,MAAM,EAAE,gBAAA/B,KAAK;AAAA,iBACX,MAAI,CAACK,KAAL,CAAW6B,OAAX,GACE,oBAAC,cAAD,oBACMlC,KADN;AAEE,YAAA,kBAAkB,EAAE,MAAI,CAACiB,kBAF3B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aADF,GAME,oBAAC,QAAD;AACE,YAAA,EAAE,EAAE;AACF8B,cAAAA,QAAQ,EAAE,QADR;AAEF1C,cAAAA,KAAK,EAAE;AAAE2C,gBAAAA,IAAI,EAAEhD,KAAK,CAACiD;AAAd;AAFL,aADN;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,YAPS;AAAA,SAFf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAvBF,EA0CE,oBAAC,KAAD;AACE,QAAA,IAAI,EAAC,eADP;AAEE,QAAA,KAAK,MAFP;AAGE,QAAA,MAAM,EAAE,gBAAAjD,KAAK;AAAA,iBACX,oBAAC,aAAD,oBACMA,KADN;AAEE,YAAA,QAAQ,EAAE,MAAI,CAACK,KAAL,CAAWc,QAFvB;AAGE,YAAA,KAAK,EAAE,MAAI,CAACd,KAAL,CAAWD,KAHpB;AAIE,YAAA,WAAW,EAAI,MAAI,CAACC,KAAL,CAAWH,IAJ5B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aADW;AAAA,SAHf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QA1CF,EAuDE,oBAAC,KAAD;AACE,QAAA,IAAI,EAAC,sBADP;AAEE,QAAA,KAAK,MAFP;AAGE,QAAA,MAAM,EAAE,gBAAAF,KAAK;AAAA,iBACX,oBAAC,aAAD,oBACMA,KADN;AAEE,YAAA,QAAQ,EAAE,MAAI,CAACK,KAAL,CAAWc,QAFvB;AAGE,YAAA,KAAK,EAAE,MAAI,CAACd,KAAL,CAAWD,KAHpB;AAIE,YAAA,WAAW,EAAI,MAAI,CAACC,KAAL,CAAWH,IAJ5B;AAKE,YAAA,kBAAkB,EAAI,MAAI,CAACyB,kBAL7B;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,aADW;AAAA,SAHf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAvDF,EAsEE,oBAAC,KAAD;AACE,QAAA,IAAI,EAAC,GADP;AAEE,QAAA,KAAK,MAFP;AAGE,QAAA,SAAS,EAAEpC,WAHb;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,QAtEF,CADJ;AA8ED;;;;EA7KeV,KAAK,CAACqE,S;;AAgLxB,IAAMC,WAAW,GAAGC,QAAQ,CAACC,cAAT,CAAwB,MAAxB,CAApB;AACAC,OAAO,CAACC,GAAR,CAAY1D,WAAZ;AACA,IAAM2D,KAAK,GAAG9D,WAAW,CAACG,WAAD,EAAaF,eAAe,CAACG,KAAD,CAA5B,CAAzB;AACAhB,QAAQ,CAAC2E,MAAT,CACE,oBAAC,QAAD;AAAU,EAAA,KAAK,EAAED,KAAjB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GACE,oBAAC,GAAD;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EADF,CADF,EAIEL,WAJF","sourcesContent":["import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport {\n  BrowserRouter as Router,\n  Redirect,\n  Route,\n  Link\n} from \"react-router-dom\";\n\nimport LoginForm from \"./components/LoginForm\";\nimport RegisterForm from \"./components/RegisterForm\";\n\nimport NewArticleForm from \"./components/NewArticleForm\";\nimport ArticleList from \"./components/ArticleList\";\nimport ArticleDetail from \"./components/ArticleDetail\";\nimport DeleteArticle from \"./components/DeleteArticle\";\n\nimport { createStore,applyMiddleware } from \"redux\";\nimport { Provider } from \"react-redux\";\nimport rootReducer from './reducers';\nimport thunk from 'redux-thunk';\n\nclass App extends React.Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      isLogin: false,\n      user: {},\n      users: [],\n      articles: [],\n      currentArticleIndex: {}\n    };\n  }\n\n  componentDidMount() {\n    this.localStorageRetrieval(\"users\");\n    this.localStorageRetrieval(\"articles\");\n  }\n\n  registerEvent = (user, cb) => {\n    const users = this.state.users;\n\n    const result = users.find(\n      obj => obj.name === user.name || obj.email === user.email\n    );\n\n    if (result === undefined) {\n      user.id = users.length + 1;\n      users.push(user);\n      this.setStateAndLocalStorage(\"users\", users);\n      cb();\n    } else {\n      alert(\"User already existed\");\n    }\n  };\n\n  addNewArticleEvent = article => {\n    const articles = this.state.articles;\n    //article.id = articles.length + 1;\n    \n    const mapped_article_id = articles.map(i => parseInt(i.id));\n    const max = Math.max(mapped_article_id);    \n    article.id = max + 1;\n    article.created_by = this.state.user.id;\n    articles.push(article);\n    this.setStateAndLocalStorage(\"articles\", articles);\n  };\n\n  deleteArticleEvent = (id,cb) =>{\n    const articles = this.state.articles;\n    const newArticles =  articles.filter( item => item.id !== id);\n    this.setStateAndLocalStorage('articles',newArticles);\n    cb();\n  }\n\n  loginEvent = (user, cb) => {\n    const users = this.state.users;\n    const result = users.find(\n      obj => obj.name === user.name && obj.password === user.password\n    );\n\n    if (result) {\n      this.setState({\n        isLogin: true,\n        user: result\n      });\n      cb();\n    } else {\n      alert(\"Wrong password\");\n    }\n  };\n\n  logoutEvent = () => {\n    this.setState({\n      isLogin: false,\n      user: {}\n    });\n  };\n\n  localStorageRetrieval(key) {\n    const data = localStorage.getItem(key);\n    if (data !== null) {\n      this.setState({\n        [key]: JSON.parse(data)\n      });\n    }\n  }\n\n  setStateAndLocalStorage(key, value) {\n    this.setState({\n      [key]: value\n    });\n    localStorage.setItem(key, JSON.stringify(value));\n  }\n\n  render() {\n    return (\n        <Router>\n          <div className=\"App\">\n            <h1>Welcome to My Blog!</h1>\n            <Link to=\"/\">Home</Link> | <Link to=\"/login\">SignIn</Link>\n            {this.state.isLogin && (\n              <React.Fragment>\n                | <Link to=\"/article/new\">New Article</Link>\n              </React.Fragment>\n            )}\n            <br />\n          </div>\n          <Route\n            path=\"/register\"\n            render={props => (\n              <RegisterForm {...props} registerEvent={this.registerEvent} />\n            )}\n          />\n          <Route\n            path=\"/login\"\n            render={props => (\n              <LoginForm {...props} loginEvent={this.loginEvent} />\n            )}\n          />\n          <Route\n            path=\"/article/new\"\n            render={props =>\n              this.state.isLogin ? (\n                <NewArticleForm\n                  {...props}\n                  addNewArticleEvent={this.addNewArticleEvent}\n                />\n              ) : (\n                <Redirect\n                  to={{\n                    pathname: \"/login\",\n                    state: { from: props.location }\n                  }}\n                />\n              )\n            }\n          />\n\n          <Route\n            path=\"/articles/:id\"\n            exact\n            render={props => (\n              <ArticleDetail\n                {...props}\n                articles={this.state.articles}\n                users={this.state.users}\n                currentUser = {this.state.user}\n              />\n            )}\n          />\n\n          <Route\n            path=\"/articles/delete/:id\"\n            exact\n            render={props => (\n              <DeleteArticle\n                {...props}\n                articles={this.state.articles}\n                users={this.state.users}\n                currentUser = {this.state.user}\n                deleteArticleEvent = {this.deleteArticleEvent}\n              />\n            )}\n          />\n\n\n          <Route\n            path=\"/\"\n            exact\n            component={ArticleList}            \n          />\n        </Router>\n    );\n  }\n}\n\nconst rootElement = document.getElementById(\"root\");\nconsole.log(rootReducer);\nconst store = createStore(rootReducer,applyMiddleware(thunk))  ;\nReactDOM.render(\n  <Provider store={store}>\n    <App />\n  </Provider>,\n  rootElement\n);\n"]},"metadata":{},"sourceType":"module"}